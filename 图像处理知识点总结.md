# Image Processing Framework

## 第一部分 图像处理基础

### 第二章 数字图像处理基础
---

#### **2.1 人眼基本构造及成像原理**
##### **2.1.1 人眼构造简介**

- **主要组成部分**：
  1. **角膜**：透明外层，保护眼睛并折射光线。
  2. **虹膜**：控制瞳孔大小，调节进入光量。
  3. **瞳孔**：虹膜中央的圆孔，类似照相机光圈。
  4. **晶状体**：弹性透明体，调节焦距（类似透镜）。
  5. **视网膜**：包含视细胞（锥状和杆状细胞），负责感光。
  6. **黄斑区**：锥状细胞密集区，分辨细节和颜色。
  7. **视神经**：传递电信号至大脑。


##### **2.1.2 人眼成像机理**
- **成像过程**：
  1. 光线通过角膜、瞳孔、晶状体聚焦到视网膜。
  2. 视细胞受光刺激产生电脉冲，经视神经传递至大脑。
- **视细胞功能**：
  - **锥状细胞**：明视觉，强光下分辨颜色和细节（集中在黄斑区）。
  - **杆状细胞**：暗视觉，弱光下仅感知亮度（无色彩，分辨率低）。

##### **2.1.3 视觉细胞敏感性**
- 三种锥状细胞对光谱敏感峰值：
  - 蓝（430 nm）、绿（540 nm）、红（570 nm）。
- **三基色原理**：三种颜色按比例混合可产生各种颜色感知。

##### **2.1.4 人眼视觉特性**
- **同时对比现象**：主观亮度受背景影响（无法判断绝对亮度）。
- **空间错觉**：人眼易受主观经验影响（如几何图形错觉）。
- **假轮廓**：低分辨率图像中出现的虚假边缘。

---

#### **2.2 图像的数字化**
##### **2.2.1 采样**
- **定义**：将连续空间图像离散化为像素网格。
- **采样依据**：
  - 细节丰富的区域需密集采样，平滑区域可稀疏采样。
  - 公式：$z = f(x, y)$，其中 $x, y$ 为离散坐标。
- **均匀采样**：等间隔采样（常用）。
- **非均匀采样**：根据细节调整采样密度（较少使用）。

##### **2.2.2 量化**
- **定义**：将连续灰度值转换为离散灰度级。
- **灰度级数**（$G$）：图像中不同灰度值的个数（通常 $G = 2^k$，$k$ 为比特位数）。
- **量化影响**：
  - 灰度级数越多，图像质量越高；过少会导致“假轮廓”。
- **量化类型**：
  - **均匀量化**：等间隔划分灰度范围（常用）。
  - **非均匀量化**：根据灰度分布调整间隔（复杂，较少用）。

##### **2.2.3 数字化原则**
- **缓变图像**：**粗采样、细量化（避免假轮廓）**。
- **细节丰富图像**：**细采样、粗量化（避免模糊）。**

---

#### **2.3 像素间的联系**
##### **2.3.1 邻域**
- **4邻域**（$N_4(p)$）：上下左右四个相邻像素。
- **对角邻域**（$N_D(p)$）：四个对角线相邻像素。
- **8邻域**（$N_8(p)$）：4邻域 + 对角邻域（共8个像素）。

##### **2.3.2 邻接性**
- **4邻接**：像素在4邻域内且灰度值相似。
- **8邻接**：像素在8邻域内且灰度值相似。
- **m邻接（混合邻接）**：
  1. 优先4邻接，若不存在则允许对角邻接（需满足中间像素不相似）。

##### **2.3.3 连通性**
- **4连通**：路径仅由4邻接像素构成。
- **8连通**：路径由8邻接像素构成。
- **m连通**：消除8邻接二义性（避免路径交叉）。

---

#### **2.4 数字图像类型和性质**
##### **2.4.1 矢量图**
- **特点**：用数学公式描述图形（如直线、曲线）。
- **优点**：文件小、放大不失真。
- **缺点**：不适合复杂色彩和渐变。

##### **2.4.2 位图**
- **类型**：
  1. **二值图像**：仅黑白两色（1 bit/像素）。
  2. **灰度图像**：256级灰度（8 bit/像素）。
  3. **真彩色图像**：RGB三通道（24 bit/像素）。
  4. **索引图像**：颜色表映射（8 bit索引值）。
- **Matlab表示**：
  - 灰度：二维矩阵；真彩色：三维矩阵；索引：矩阵 + 颜色表。

##### **2.4.3 图像性质**
1. **分辨率**：
   - **图像分辨率**：像素数（如1024×768）。
   - **显示器分辨率**：屏幕可显示像素数（如1920×1080）。
2. **图像深度**：存储每个像素的比特数（如24 bit）。
3. **图像大小**：计算式 $\text{分辨率} \times \text{深度} / 8$（单位：字节）。

---

#### **2.5 常用图像文件格式**
1. **BMP**：
   - 无压缩，文件头 + 位图数据（体积大）。
2. **TIF**：
   - 支持多平台，扩展性强（适合印刷）。
3. **GIF**：
   - 256色，支持动画，LZW无损压缩（适合简单图形）。
4. **JPEG**：
   - 有损压缩，高压缩比（适合照片）。
5. **PCX**：
   - 早期扫描仪格式，压缩适中。

---

**复习重点**：
- 人眼成像原理与视觉特性（锥状/杆状细胞区别）。
- 采样量化原则及对图像质量的影响。
- 邻接性与连通性（区分4邻接、8邻接、m邻接）。
- 位图类型及Matlab表示方法。
- 图像分辨率与数据量计算。
- 文件格式特点（JPEG有损压缩 vs. GIF无损压缩）。



### 第三章 图像变换

---

#### **3.0 图像的Matlab基本操作**
##### **3.0.1 图像读取**
1. **`imread`函数**：
   - 格式：`[X, MAP] = imread('FILENAME.FMT')`
   - 功能：读取图像文件（支持多种格式），返回图像数据`X`和调色板`MAP`。
   - 示例：
     ```matlab
     [I, map] = imread('moon.tif');
     ```

2. **`imfinfo`函数**：
   - 格式：`INFO = imfinfo('FILENAME.FMT')`
   - 功能：获取图像文件信息（分辨率、位深度等），返回结构体`INFO`。

##### **3.0.2 图像显示**
1. **`imshow`函数**：
   - **灰度图像**：
     ```matlab
     imshow(I, n);   % n为灰度级（默认256）
     imshow(I, [low, high]); % 指定灰度范围显示
     ```
   - **二值图像**：
     ```matlab
     imshow(BW);
     ```
   - **真彩色图像**：
     ```matlab
     imshow(RGB);
     ```

2. **`colorbar`函数**：
   - 显示颜色条，辅助查看灰度或颜色分布。

3. **直接显示图像文件**：
   ```matlab
   imshow('moon.tif');
   ```

##### **3.0.3 图像保存**
1. **`imwrite`函数**：
   - 格式：`imwrite(I, 'filename.fmt')` 或 `imwrite(X, MAP, 'filename.fmt')`
   - 示例：
     ```matlab
     imwrite(I, 'output.jpg', 'Quality', 75);  % 保存为JPEG，质量75%
     ```

---

#### **3.1 概述**
- **图像表示法**：
  - **空间域**：直接处理像素值（如几何变换）。
  - **变换域**：通过频域分析处理（如傅里叶变换）。
- **几何变换核心**：改变像素位置而不改变像素值，用于校正畸变、图像配准等。

---

#### **3.2 图像的几何变换**
##### **3.2.1 位置变换**
1. **平移**：
   - 公式：$x' = x + \Delta x$, $y' = y + \Delta y$
   - **注意**：平移后需扩展画布，否则图像部分区域丢失。

2. **镜像**：
   - **水平镜像**：$x' = x$, $y' = height - y$
   - **垂直镜像**：$x' = width - x$, $y' = y$
   - **实现步骤**：需调整坐标系避免负索引。

3. **旋转**：
   - 公式（绕原点逆时针旋转θ）：
     $$
     x' = x\cos\theta - y\sin\theta, \quad y' = x\sin\theta + y\cos\theta
     $$
   - **关键问题**：
     - **坐标平移**：避免旋转后部分图像超出画布（需调整坐标系原点）。
     - **插值处理**：填充旋转后的空洞点（如行插值或列插值）。
   - **Matlab函数**：`imrotate(I, angle, 'method')`（`method`可选`nearest`、`bilinear`等）。

##### **3.2.2 形状变换**
1. **缩小**：
   - **按比例缩小**：取原图偶/奇行列（如缩小一半）。
   - **任意比例缩小**：计算缩放因子$c=1/k$，取整坐标。
   - **Matlab函数**：`imresize(I, scale)`。

2. **放大**：
   - **按比例放大**：将每个像素复制到$k \times k$子块中。
   - **任意比例放大**：可能导致几何畸变。
   - **示例**：
     ```matlab
     I_large = imresize(I, 2);  % 放大2倍
     ```

3. **错切变换**：
   - **公式**：
     - x方向错切：$x' = x + d_x \cdot y$, $y' = y$
     - y方向错切：$x' = x$, $y' = y + d_y \cdot x$
   - **效果**：模拟非垂直投影，导致图像扭曲。

---

#### **3.3 图像的频域变换**
- **核心思想**：将图像从空间域转换到频域（如傅里叶变换），便于滤波、压缩等操作。
- **常用方法**：傅里叶变换、小波变换。

---

#### **本章重点总结**
1. **Matlab操作**：
   - 掌握`imread`、`imshow`、`imwrite`的使用。
   - 理解灰度范围调整（如`imshow(I, [])`自动归一化）。

2. **几何变换**：
   - **位置变换**：平移、镜像、旋转（注意插值处理）。
   - **形状变换**：缩放（按比例/任意比例）、错切。
   - **应用场景**：图像校正、配准、畸变修复。

3. **易错点**：
   - 旋转后需插值填补空洞。
   - 不按比例缩放的几何畸变问题。

---

**复习建议**：
- 结合Matlab代码示例理解几何变换的实现步骤。
- 通过实验对比不同插值方法的效果（如`nearest`与`bilinear`）。
- 掌握几何变换的数学公式与实际应用的对应关系。




### 第四章 图像增强
---

#### **4.1 概述**
- **概念**：通过技术改善图像视觉效果或转换为更适合分析的形式，不以保真为准则，强调突出有用信息。
- **方法分类**：
  - **空域法**：直接处理像素。
    - 点处理（灰度变换、直方图修正）。
    - 模板处理（空域滤波）。
  - **频域法**：通过傅里叶变换在频率域处理（低通、高通、同态滤波）。

---

#### **4.2 空域点处理增强**
##### **4.2.1 灰度变换**
1. **图像求反**：
   - 公式：$s = L-1 - t$（$L$为灰度级总数）。
   - 应用：增强暗区中的亮细节（如医学图像）。

2. **线性灰度变换**：
   
   - 公式：分段线性函数拉伸对比度。
     $$
     g(x,y) = 
     \begin{cases} 
     c & f(x,y) < a \\
     \frac{d-c}{b-a}(f(x,y)-a) + c & a \leq f(x,y) \leq b \\
     d & f(x,y) > b 
     \end{cases}
     $$
   - 应用：曝光不足/过度的图像增强。
   
3. **非线性变换**：
   - **对数变换**：$s = c \cdot \log(1 + t)$，扩展低灰度区，压缩高灰度区。
   - **指数变换**：$s = c \cdot (e^{t} - 1)$，扩展高灰度区，压缩低灰度区。


##### **4.2.2 直方图修正**
1. **直方图均衡化**：
   - **步骤**：
     1. 统计原图灰度级频率$p(r_k) = \frac{n_k}{n}$。
     2. 计算累积分布$s_k = \sum_{j=0}^k p(r_j)$。
     3. 映射$s_k$到最近的离散灰度级。
   - **效果**：全局对比度增强，但可能丢失部分细节。

2. **直方图规定化**：
   - **目标**：使图像直方图匹配特定分布（如均匀、高斯）。
   - **步骤**：
     1. 对原图和目标图分别进行均衡化，得到映射关系。
     2. 将原图的均衡化结果映射到目标直方图。

##### **4.2.3 图像运算**
1. **算术运算**：
   - **加法**：降噪（多图平均）、图像叠加。
   - **减法**：检测变化（如运动物体）。
   - **乘法/除法**：校正光照不均。

2. **逻辑运算**：
   - **与/或**：图像合成、区域提取。
   - **非**：生成负片效果。

---

#### **4.3 空域滤波增强**
##### **4.3.1 平滑滤波器**
1. **线性平滑（均值滤波）**：
   - **模板**：3×3或5×5的均值模板。
   - **效果**：去噪但导致边缘模糊。
   - **公式**：$g(x,y) = \frac{1}{9}\sum_{i=-1}^1 \sum_{j=-1}^1 f(x+i, y+j)$。

2. **中值滤波**：
   - **原理**：用邻域像素的中值替代中心像素。
   - **优势**：有效去除椒盐噪声且保留边缘。

##### **4.3.2 锐化滤波器**
1. **梯度算子**：
   - **Sobel算子**（边缘检测）：
     - 水平模板：
     - $$\begin{bmatrix} -1 & 0 & 1 \\ -2 & 0 & 2 \\ -1 & 0 & 1 \end{bmatrix}$$
     - 垂直模板：
     - $$ \begin{bmatrix} -1 & -2 & -1 \\ 0 & 0 & 0 \\ 1 & 2 & 1 \end{bmatrix} $$
   - **Prewitt算子**：类似Sobel，但权重不同。

2. **拉普拉斯算子**：
   - **模板**：
   - $$\begin{bmatrix} 0 & -1 & 0 \\ -1 & 4 & -1 \\ 0 & -1 & 0 \end{bmatrix}$$
   - **效果**：突出边缘，公式：
   - $\nabla^2 f = f(x+1,y) + f(x-1,y) + f(x,y+1) + f(x,y-1) - 4f(x,y)$。

---

#### **4.4 频域滤波增强**
##### **4.4.1 低通滤波器**
1. **理想低通滤波**：
   - **公式**：$H(u,v) = \begin{cases} 1 & D(u,v) \leq D_0 \\ 0 & \text{其他} \end{cases}$
   - **缺点**：产生振铃效应。

2. **巴特沃斯低通滤波**：
   - **公式**：$H(u,v) = \frac{1}{1 + (D(u,v)/D_0)^{2n}}$
   - **特点**：平滑过渡，减少振铃。

##### **4.4.2 高通滤波器**
1. **理想高通滤波**：$H(u,v) = 1 - \text{理想低通}$
2. **巴特沃斯高通滤波**：$H(u,v) = \frac{1}{1 + (D_0/D(u,v))^{2n}}$
3. **高频加强滤波**：$H'(u,v) = H(u,v) + c$（增强边缘同时保留部分低频信息）。

##### **4.4.3 同态滤波**
- **原理**：分离光照（低频）和反射（高频）分量，分别增强。
- **步骤**：
  1. 取对数：$\ln f(x,y) = \ln i(x,y) + \ln r(x,y)$
  2. 傅里叶变换后滤波。
  3. 反变换并取指数。

---

#### **重点总结**
1. **直方图均衡化**是全局对比度增强的核心方法，需掌握计算步骤。
2. **中值滤波**在去除椒盐噪声时优于均值滤波。
3. **Sobel算子**通过水平和垂直模板检测边缘方向。
4. **频域滤波**需理解低通/高通的作用及巴特沃斯滤波器的平滑特性。
5. **同态滤波**适用于光照不均的图像增强。

---

**复习建议**：
- 结合Matlab代码实践灰度变换（`imadjust`）和滤波（`fspecial`, `imfilter`）。
- 对比不同滤波器的效果（如理想 vs. 巴特沃斯）。
- 通过例题掌握直方图均衡化的计算过程。




### 第五章 图像复原

---

#### **5.1 概述**
- **图像增强 vs. 图像复原**：
  - **增强**：改善视觉效果，主观性强。
  - **复原**：基于退化模型恢复图像本质，以保真为原则。
- **退化原因**：运动模糊、噪声污染、几何畸变（镜头畸变、传感器非线性等）。
- **复原方法分类**：
  - **空域法**：直接处理像素（如滤波）。
  - **频域法**：通过傅里叶变换处理（如逆滤波、维纳滤波）。

---

#### **5.2 图像退化模型**
##### **5.2.1 线性退化模型**
- **公式**：  
  $$
  g(x,y) = f(x,y) \ast h(x,y) + n(x,y)
  $$
  - $g(x,y)$：退化图像，$f(x,y)$：原始图像，$h(x,y)$：退化函数（点扩散函数），$n(x,y)$：加性噪声。
- **频域表示**：  
  $$
  G(u,v) = F(u,v) \cdot H(u,v) + N(u,v)
  $$

##### **5.2.2 离散退化模型**
- **循环矩阵表示**：  
  $$
  \mathbf{g} = \mathbf{Hf} + \mathbf{n}
  $$
  - $\mathbf{H}$：分块循环矩阵，描述退化过程。

##### **5.2.3 典型退化模型**
1. **运动模糊模型**：
   - **退化函数**：  
     $$
     H(u,v) = \frac{\sin(\pi(au + bv))}{\pi(au + bv)} e^{-j\pi(au + bv)}
     $$
   - 适用于匀速直线运动造成的模糊。
2. **大气湍流模型**：  
   $$
   H(u,v) = e^{-k(u^2 + v^2)^{5/6}}
   $$
   - $k$：湍流强度参数。

---

#### **5.3 退化函数估计**
1. **图像观察法**：通过简单结构区域（如边缘）估计退化函数。
2. **试验法**：利用已知冲激信号（如点光源）的退化结果直接测量。
3. **模型法**：根据物理过程建模（如运动模糊、高斯模糊）。

---

#### **5.4 逆滤波**
- **原理**：直接逆解退化函数，忽略噪声影响。
  $$
  \hat{F}(u,v) = \frac{G(u,v)}{H(u,v)}
  $$
- **问题**：噪声在$H(u,v)$接近零时被放大。
- **改进**：限制频率范围（截断高频噪声）。

---

#### **5.5 维纳滤波**
- **目标**：最小化复原图像与原始图像的均方误差。
- **滤波函数**：  
  $$
  H_w(u,v) = \frac{H^*(u,v)}{|H(u,v)|^2 + \frac{P_n(u,v)}{P_f(u,v)}}
  $$
  - $P_n(u,v)$：噪声功率谱，$P_f(u,v)$：图像功率谱。
- **Matlab实现**：  
  ```matlab
  fr = deconvwnr(g, PSF, NSR);  % NSR为噪信比
  ```

---

#### **5.6 约束最小二乘滤波**
- **核心思想**：引入平滑约束，抑制噪声放大。
- **滤波函数**：  
  $$
  H_{cls}(u,v) = \frac{H^*(u,v)}{|H(u,v)|^2 + \gamma |P(u,v)|^2}
  $$
  - $P(u,v)$：拉普拉斯算子的傅里叶变换，$\gamma$：调节参数。
- **Matlab实现**：  
  ```matlab
  fr = deconvreg(g, PSF, NOISEPOWER);  % NOISEPOWER为噪声功率
  ```

---

#### **5.7 从噪声中复原**
##### **5.7.1 噪声模型**
- **常见噪声类型**：
  | 噪声类型       | 概率密度函数 (PDF)                  | 特点               |
  |----------------|-------------------------------------|--------------------|
  | 高斯噪声       | $p(z) = \frac{1}{\sigma\sqrt{2\pi}} e^{-\frac{(z-\mu)^2}{2\sigma^2}}$ | 对称，广泛存在     |
  | 椒盐噪声       | $p(z) = \begin{cases} P_a & z=0 \\ P_b & z=255 \end{cases}$ | 极值脉冲           |
  | 瑞利噪声       | $p(z) = \frac{2}{b}(z-a)e^{-\frac{(z-a)^2}{b}}$ | 非对称，多用于雷达 |
  | 指数噪声       | $p(z) = a e^{-az}$                | 快速衰减           |

##### **5.7.2 空域滤波**
1. **均值滤波**：
   - **算术均值**：平滑噪声，模糊边缘。
   - **几何均值**：保留细节，抑制高斯噪声。
2. **顺序统计滤波**：
   - **中值滤波**：有效去除椒盐噪声。
   - **最大值/最小值滤波**：去除极值噪声（如盐噪声或胡椒噪声）。

##### **5.7.3 频域滤波**
- **带阻滤波器**：抑制特定频率噪声（如周期噪声）。
- **同态滤波**：分离光照（低频）和反射（高频）分量，增强对比度。

---

#### **5.8 几何失真校正**
1. **空间变换**：
   - **仿射变换**：包括平移、旋转、缩放，形式为：  
     $$
     \begin{bmatrix} x' \\ y' \end{bmatrix} = \begin{bmatrix} a & b \\ c & d \end{bmatrix} \begin{bmatrix} x \\ y \end{bmatrix} + \begin{bmatrix} t_x \\ t_y \end{bmatrix}
     $$
2. **灰度插值**：
   - **最近邻插值**：速度快，但产生锯齿。
   - **双线性插值**：平滑效果，计算量适中。
3. **Matlab实现**：
   ```matlab
   tform = maketform('affine', T);  % 定义仿射变换
   g = imtransform(f, tform, 'XData', X, 'YData', Y);  % 执行变换
   ```

---

#### **重点总结**
1. **退化模型**：掌握线性退化公式及频域表示，理解运动模糊和湍流模型。
2. **逆滤波 vs. 维纳滤波**：
   - 逆滤波简单但噪声敏感，维纳滤波引入噪声功率谱优化复原。
3. **约束最小二乘滤波**：通过平滑约束抑制噪声，需调节参数$\gamma$。
4. **噪声处理**：根据噪声类型选择滤波方法（如中值滤波去椒盐噪声）。
5. **几何校正**：空间变换+灰度插值，注意仿射变换参数和插值方法的影响。

---

**复习建议**：
- 结合Matlab代码（`deconvwnr`, `deconvreg`）理解滤波器的实际应用。
- 通过例题掌握运动模糊的建模与消除步骤。
- 对比不同噪声模型的PDF特征及适用场景。




### 第六章 彩色图像处理
---

#### **6.1 彩色基础**
##### **6.1.1 人眼视觉特性**
1. **三色原理**：
   - 人眼视网膜包含三种视锥细胞，分别对 **蓝（430 nm）**、**绿（540 nm）**、**红（570 nm）** 敏感。
   - 颜色感知由三原色（RGB）按比例混合产生。
   - **光的三原色**：红（R）、绿（G）、蓝（B）——加色混合（如显示器）。
   - **色素三原色**：青（C）、品红（M）、黄（Y）——减色混合（如印刷）。

##### **6.1.2 颜色感知**
- **补色关系**：
  - 青（C）= 白 - 红，品红（M）= 白 - 绿，黄（Y）= 白 - 蓝。
- **成像过程**：光刺激视细胞→电脉冲→视神经→大脑成像。

---

#### **6.2 颜色模型**
##### **6.2.1 RGB模型**
- **原理**：基于光的三原色，通过不同强度的红、绿、蓝叠加生成颜色。
- **应用**：显示器、数字图像存储。
- **公式**：颜色表示为三维向量 $[R, G, B]$，取值范围通常为0-255。

##### **6.2.2 CMY/CMYK模型**
- **原理**：减色模型，通过吸收特定波长光生成颜色。
  - **CMY转换公式**：
    $$
    \begin{bmatrix} C \\ M \\ Y \end{bmatrix} = \begin{bmatrix} 1 \\ 1 \\ 1 \end{bmatrix} - \begin{bmatrix} R \\ G \\ B \end{bmatrix}
    $$
  - **CMYK扩展**：加入黑色（K）以提高印刷质量，公式：
    $$
    K = \min(C, M, Y), \quad C' = C - K, \quad M' = M - K, \quad Y' = Y - K
    $$
- **应用**：印刷、喷墨打印。

##### **6.2.3 HSI模型**
- **原理**：基于色调（Hue）、饱和度（Saturation）、亮度（Intensity）描述颜色。
  - **H（色调）**：颜色类型（如红、蓝），角度值（0°-360°）。
  - **S（饱和度）**：颜色纯度，0（灰）→1（纯色）。
  - **I（亮度）**：颜色明暗程度，0（黑）→1（白）。
- **优点**：符合人类主观颜色感知，适合图像分割、增强。
- **转换公式**（RGB→HSI）：
  - 归一化RGB：$r = \frac{R}{R+G+B}, \ g = \frac{G}{R+G+B}, \ b = \frac{B}{R+G+B}$
  - 色调 $H = \arccos\left(\frac{2r - g - b}{2\sqrt{(r - g)^2 + (r - b)(g - b)}}\right)$
  - 饱和度 $S = 1 - 3\min(r, g, b)$
  - 亮度 $I = \frac{R + G + B}{3}$

---

#### **6.3 全彩色图像处理**
##### **6.3.1 空域处理**
1. **平滑滤波**：
   - **邻域平均法**：对RGB三通道分别进行均值滤波。
     $$
     \hat{R}(x,y) = \frac{1}{K} \sum_{(s,t) \in S_{xy}} R(s,t), \quad G, B \text{同理}
     $$
   - **效果**：减少噪声，但可能导致边缘模糊。
2. **锐化滤波**：
   - **拉普拉斯算子**：增强边缘，公式：
     $$
     \nabla^2 I(x,y) = I(x+1,y) + I(x-1,y) + I(x,y+1) + I(x,y-1) - 4I(x,y)
     $$
   - **应用**：对亮度通道（HSI中的I）进行锐化，避免颜色失真。

##### **6.3.2 频域处理**
- **颜色通道分离**：对RGB各通道分别进行傅里叶变换，滤波后反变换。
- **HSI模型应用**：在亮度通道（I）进行频域滤波（如高通滤波锐化）。

---

#### **6.4 伪彩色处理**
##### **6.4.1 密度分层法**
- **原理**：将灰度图像按灰度级分层，每层赋予不同颜色。
  - 例：灰度0-85→红色，86-170→绿色，171-255→蓝色。
- **应用**：医学成像（如X光片增强对比度）。

##### **6.4.2 灰度级-彩色变换法**
- **原理**：通过三个独立的灰度变换函数生成RGB通道，合成伪彩色图像。
  - 例：$R = f_1(gray), \ G = f_2(gray), \ B = f_3(gray)$
- **效果**：突出不同灰度范围的细节。

##### **6.4.3 频域滤波法**
- **原理**：对灰度图像进行频域滤波，不同频率分量映射为不同颜色。
  - 例：低频→红色，中频→绿色，高频→蓝色。
- **应用**：遥感图像分析（区分地貌特征）。

---

#### **重点总结**
1. **颜色模型**：
   - **RGB**：加色混合，适合显示设备。
   - **CMY/CMYK**：减色混合，用于印刷。
   - **HSI**：符合人类视觉，适合图像处理。
2. **全彩色处理**：
   - 平滑和锐化需分通道处理，或通过HSI模型避免颜色失真。
3. **伪彩色处理**：
   - 通过灰度映射或频域分析增强图像可解释性。

---


### 第七章 图像编码

---

#### **7.1 编码概述**
1. **数据冗余**  
   - **定义**：图像中存在的非必要或重复信息。  
   - **类型**：  
     - **编码冗余**：使用非最优编码方案导致的冗余（如等长编码）。  
     - **像素冗余**：像素间高度相关性（如相邻像素值相似）。  
     - **心理视觉冗余**：人眼不敏感的细节，可舍弃而不影响感知质量。  
   - **压缩依据**：通过消除冗余减少数据量。

2. **图像压缩与编码**  
   - **无损压缩**：保留全部信息，压缩比低（如Huffman编码）。  
   - **有损压缩**：允许信息损失，压缩比高（如DCT变换编码）。  
   - **应用场景**：  
     - 医学图像需无损压缩；  
     - 视频流常用有损压缩。

3. **质量评价**  
   - **客观指标**：  
     - **均方误差（MSE）**：$E_{\text{mse}} = \frac{1}{NM} \sum_{i=1}^N \sum_{j=1}^M (f(i,j) - \hat{f}(i,j))^2$  
     - **峰值信噪比（PSNR）**$\text{PSNR} = 10 \log_{10} \left( \frac{\text{MAX}^2}{\text{MSE}} \right)$，MAX为像素最大值（如255）。  
   - **主观评价**：  
     - **MOS（平均意见分）**：通过人工评分量化视觉质量。

4. **图像压缩常见的方式**  

   - 在图像或信号处理的背景下，压缩方法通常分为不同的类别，常见的是：**预测编码法**和**变换编码法**

   - **预测编码法**：基于像素值的相邻关系进行编码，如差分编码等。预测编码方法可以是有损或无损，具体取决于实施方法和应用要求。
   - **变换编码法**：基于图像的频率分量进行编码，如DCT变换、DWT变换等。变换编码方法通常是用于有损压缩，但也可以在特定情况下实现无损压缩。
  

##### 7.1.1 预测编码方法（对应空域方法）
- **定义**：预测编码方法通常利用图像中相邻像素值之间的相关性来减少数据量。这种方法假设当前像素的值可以根据其邻近像素的值进行预测。
- **优点**：
  - 通过利用局部的相关性，可以有效缩减图像数据的冗余，从而压缩图像大小。
  - 在空域方法中，数据变化通常比较简单，如线性预测或差分编码等。

- **应用例子**： 
  - 减去相邻像素的值，得到残差，然后对残差进行编码。
  - 例如，JPEG图像压缩标准中使用了一定的预测编码技术。

##### 7.1.2 变换编码方法（对应频域方法）
- **定义**：变换编码方法通过将图像数据从空间域（像素值）转换到频域（频率分量）进行处理。这通常涉及将信号进行傅里叶变换、小波变换或离散余弦变换（DCT）。
- **优点**：
  - 在频域中，图像中重要信息（高频信息）与不重要信息（低频信息）的分离，可以帮助集中精力处理那些更重要的成分，从而减小数据量。
  - 可以通过去除不必要的频率成分，压缩效果通常较好。

- **应用例子**：
  - JPEG图像压缩广泛采用离散余弦变换（DCT）作为变换编码方法，在频域上对图像进行处理，去掉一些不明显的高频信息，从而达到压缩效果。

##### 两种方法总结
这两种方法可以单独使用，也可以结合使用，以实现更高效的数据压缩。


---

#### **7.2 信息理论与熵编码**
1. **离散信源的熵**  
   - **信息量**：符号$x_k$的信息量为 $I(x_k) = -\log_2 p(x_k)$。  
   - **信源熵（H）**：平均信息量，$H(X) = -\sum_{k=1}^N p(x_k) \log_2 p(x_k)$。  
   - **物理意义**：无损压缩的极限，平均码长 $\geq H$。

2. **编码定理**  
   - **变长最佳编码定理**：概率高的符号用短码，概率低的用长码。  
   - **压缩比**：$CR = \frac{n_1}{n_2}$，$n_1$、$n_2$为压缩前后的平均码长。
   - **最大离散熵定理**: 对于非等概率分布的信源，采用不等长编码其平均码长**小于**等长编码的平均码长。如果信源中各符号的出现概率相等，信源熵值达到最大，这是最大离散熵定理。**如果码字长度严格按照所对应符号出现概率大小逆序排列，则编码结果平均码字长度一定小于任何其他排列形式。**

3. **编码算法**  
   - **Huffman编码**：  
     1. 按概率降序排列符号；  
     2. 合并最小概率符号，构建二叉树；  
     3. 分配码字（左分支0，右分支1）。  
     - **示例**：符号集{ A(0.4), B(0.25), C(0.15), D(0.15), E(0.05) }，码字为A=0, B=10, C=110, D=1110, E=1111。  
     - **平均码长**：$ L = 0.4 \times 1 + 0.25 \times 2 + 0.15 \times 3 \times 2 + 0.05 \times 4 = 2.2 $ bits。  

   - **Shannon-Fano编码**：  
     1. 按概率降序排列；  
     2. 递归分割为两组，使概率和接近；  
     3. 分配码字（上组0，下组1）。  

   - **算术编码**：  
     - 将整个消息映射到[0,1)区间，通过区间划分编码。  

---


##### 7.2.1 **Huffman编码**  
   - **步骤总结**：  
     1. **概率降序排列**：将符号按概率从高到低排序（如S1:0.4, S2:0.175, S3:0.15, S4:0.15, S5:0.125）。  
     2. **合并最小概率节点**：重复合并概率最小的两个节点，构建二叉树。  
        - 合并过程：  
          - 初始：S5(0.125) + S4(0.15) → 0.275  
          - 合并 S2(0.175)+ S3(0.15) → 0.325 
          - 合并 0.275+ 0.325 → 0.6  
          - 最终合并0.6 + S1(0.4) → 1.0  
     3. **分配码字**：左分支为0，右分支为1（或相反），从根到叶子路径生成码字。  
        - 结果：S1=0, S2=111, S3=110, S4=101, S5=100。  
   - **性能计算**：  
     - **平均码长**：$L = 0.4×1 + 0.175×3 + 0.15×3 + 0.15×3 + 0.125×3 = 2.2$ bits/符号。  
     - **信源熵**：$H(X) = -\sum p_i \log_2 p_i ≈ 2.1649$ bits，验证 $L \geq H$。  

##### 7.2.2 **Shannon-Fano编码**  
   - **步骤**：  
     1. **概率降序排列**（同Huffman）。  
     2. **递归分割**：将符号集分为两组，使两组概率和尽可能接近。  
        - 例7.6分割过程：  
          - 第一层：S1(0.4) | S2+S3+S4+S5(0.6) → 分配码字0和1。  
          - 第二层：S2(0.175) | S3+S4+S5(0.425) → 分配0和1。  
          - 最终码字：S1=0, S2=10, S3=110, S4=1110, S5=1111。  
   - **平均码长**：$ L = 0.4×1 + 0.175×2 + 0.15×3 + 0.15×4 + 0.125×4 = 2.275 $ bits。  

##### 7.2.3 **算术编码**  
   - **核心思想**：将整个消息映射到[0,1)区间，通过概率划分动态压缩。  
   - **示例**：对符号串BACC进行编码（概率：A=0.4, B=0.2, C=0.4）。  
     - **初始区间**：A[0,0.4), B[0.4,0.6), C[0.6,1.0)。  
     - **编码过程**：  
       1. **B**：选中B区间[0.4,0.6)。  
       2. **A**：在B区间内划分A的新区间为 $0.4 + 0.4×(0.6-0.4) = 0.48$，区间更新为[0.4,0.48)。  
       3. **C**：在A区间内划分C的新区间为 $0.4 + 0.6×(0.48-0.4) = 0.448$，区间更新为[0.448,0.48)。  
       4. **C**：再次划分C区间为 $0.448 + 0.6×(0.48-0.448) = 0.4672$，最终区间[0.4672,0.48)。  
     - **结果**：取区间中值0.4736，二进制表示为0.01111001101（保留小数点后10位）。  

---

##### **关键对比与总结**
| **编码方法**   | **特点**                                                                 | **适用场景**               |  
|----------------|--------------------------------------------------------------------------|---------------------------|  
| **Huffman**    | 码长不等，平均码长最短，但构造不唯一，硬件实现复杂。                     | 通用无损压缩（如ZIP）。    |  
| **Shannon-Fano**| 码长接近Huffman，但分割策略可能导致效率略低。                           | 理论教学或简单应用。       |  
| **算术编码**    | 无固定码表，区间划分灵活，压缩率更高，但计算复杂度高。                 | 高压缩比需求（如JPEG2000）。|  

---


#### **7.3 变换编码**
1. **核心思想**  
   - 将图像从空域转换到频域，利用能量集中特性实现压缩。  
   - **步骤**：子图像分割 → 变换 → 量化 → 编码。

2. **变换选择**  
   - **FFT（快速傅里叶变换）**：  
     - **公式**：  
       $$
       F(u, v) = \sum_{x=0}^{N-1} \sum_{y=0}^{N-1} f(x, y) e^{-j2\pi(ux/N + vy/N)}
       $$
     - **缺点**：复数运算复杂，能量分散，压缩效率较低。  
     - **例7.14**：  
       - 压缩比2:1时，RMSE=0.0398；压缩比8:1时，RMSE=0.0474（图像质量明显下降）。  

   - **DCT（离散余弦变换）**：  
     - **公式**：  
       $$
       F(u, v) = \frac{2}{N} C(u)C(v) \sum_{x=0}^{N-1} \sum_{y=0}^{N-1} f(x, y) \cos\left(\frac{(2x+1)u\pi}{2N}\right) \cos\left(\frac{(2y+1)v\pi}{2N}\right)
       $$
       - 其中，$C(u) = \sqrt{1/2}$（当 $u=0$ 时），否则 $C(u)=1$。  
     - **优点**：实数运算，能量集中在低频系数，适合图像压缩（如JPEG）。  
     - **例7.13**：DCT压缩后通过逆变换（IDCT）重建图像，压缩比8:1时RMSE=0.0489。

3. **子图像尺寸选择**  
   - **常用尺寸**：4×4、8×8、16×16。  
   - **选择依据**：  
     - **较小尺寸（如4×4）**：计算快，但压缩能力有限（难以充分去相关）。  
     - **较大尺寸（如16×16）**：去相关效果好，但计算复杂，且图像局部相关性弱时效果饱和。  
   - **平衡点**：8×8块兼顾计算效率和压缩效果（JPEG标准采用）。

4. **比特分配**  
   - **目标**：保留重要系数，舍弃次要系数。  
   - **策略**：  
     - **区域编码**：保留低频系数（高能量区域），舍弃高频系数。  
       - **原理**：低频系数携带图像主要信息（如轮廓）。  
     - **阈值编码**：设定阈值，保留幅值超过阈值的系数（保留部分高频细节）。  
       - **示例**：若阈值=10，则所有DCT系数绝对值<10的置零。  
   - **量化表**：定义不同频率系数的量化步长（低频细量化，高频粗量化）。

5. **DCT编码流程（JPEG示例）**  
   1. **分割**：将图像分为8×8子块。  
   2. **DCT变换**：将每个子块转换为频域系数。  
   3. **量化**：使用量化表对系数进行舍入（如低频系数步长小，高频步长大）。  
   4. **熵编码**：对量化后的系数进行Zig-Zag扫描 + Huffman编码。  
   5. **重建**：解码后通过IDCT恢复图像。

---

#### **关键总结**
| **技术**         | **特点**                                                                 | **适用场景**         |  
|-------------------|--------------------------------------------------------------------------|---------------------|  
| **FFT**           | 复数运算，能量分散，压缩效率低。                                         | 较少用于图像压缩。  |  
| **DCT**           | 实数运算，能量集中，压缩效率高。                                         | JPEG、MPEG等标准。  |  
| **区域编码**       | 保留低频系数，舍弃高频系数。                                             | 高压缩比需求。      |  
| **阈值编码**       | 保留超过阈值的系数（包括部分高频细节）。                                   | 需保留细节的场景。  |  

---

#### **典型考题**
1. **简答**：为什么JPEG标准选择DCT而非FFT？  
   **答**：DCT为实数运算，计算高效，且能量集中特性优于FFT，适合图像压缩。

2. **计算**：对8×8子块进行DCT变换，若量化步长为$$16, 11, 10, ...$$（JPEG亮度量化表），求量化后系数。  
   **步骤**：  
   - 计算DCT系数 $F(u, v)$。  
   - 量化：$Q(u, v) = \text{round}(F(u, v) / \text{量化步长}[u][v])$。  

3. **分析**：若子图像尺寸从8×8改为16×16，压缩效果会如何变化？  
   **答**：去相关性增强，但计算复杂度大幅上升，且局部细节可能丢失。

---





### 第八章 图像检测与分割

---

#### **8.1 概述**
- **定义**：将图像分解为有意义区域并定位目标的过程，是计算机视觉中的核心问题。
- **核心任务**：基于灰度不连续性（边缘检测）或区域相似性（阈值分割、区域分割）分离目标。
- **应用场景**：目标识别、医学影像分析、工业检测等。

---

#### **8.2 边缘检测**
1. **梯度算子**  
   - **原理**：利用图像灰度的一阶导数检测边缘（灰度突变处）。  
   - **常用算子**：  
     | **算子**      | **模板（水平/垂直）**                 | **特点**                          |  
     |---------------|--------------------------------------|-----------------------------------|  
     | **Roberts**   | $\begin{bmatrix}1 & 0\\0 & -1\end{bmatrix}$ | 检测对角线边缘，对噪声敏感。       |  
     | **Sobel**     | $\begin{bmatrix}-1 & 0 & 1\\-2 & 0 & 2\\-1 & 0 & 1\end{bmatrix}$ | 加权平均抑制噪声，边缘较粗。       |  
     | **Prewitt**   | $\begin{bmatrix}-1 & 0 & 1\\-1 & 0 & 1\\-1 & 0 & 1\end{bmatrix}$ | 类似Sobel，但平滑效果较弱。        |  

   - **效果对比**：  
     - **Roberts**：边缘细但噪声敏感。  
     - **Sobel/Prewitt**：边缘较粗，抗噪性较好。  

2. **拉普拉斯算子**  
   - **原理**：利用二阶导数检测边缘（零交叉点）。  
   - **模板**：$\begin{bmatrix}0 & 1 & 0\\1 & -4 & 1\\0 & 1 & 0\end{bmatrix}$  
   - **缺点**：对噪声敏感，需结合高斯滤波（LOG算子）。  

3. **Canny边缘检测**  
   - **步骤**：  
     1. **高斯滤波**：平滑图像抑制噪声。  
     2. **梯度计算**（Sobel算子）。  
     3. **非极大值抑制**：保留梯度方向上的局部最大值。  
     4. **双阈值检测**：高阈值（强边缘）与低阈值（弱边缘），通过连接消除断点。  
   - **优点**：抗噪性强，边缘连续且定位准确。  

4. **算子对比**  
   | **算子**      | **抗噪性** | **边缘精度** | **计算复杂度** |  
   |---------------|------------|--------------|----------------|  
   | Roberts        | 低         | 高           | 低             |  
   | Sobel/Prewitt | 中         | 中           | 中             |  
   | Laplacian     | 低         | 高           | 低             |  
   | Canny         | 高         | 高           | 高             |  

---

#### **8.3 边界跟踪**
1. **基本思想**  
   - 通过局部搜索将离散边缘点连接成连续边界。  
   - **步骤**：  
     1. 初始化起点。  
     2. 按方向优先级（如8邻域顺时针）搜索下一个边缘点。  
     3. 标记已访问点，避免重复。  

2. **霍夫变换**  
   - **原理**：将图像空间中的直线/曲线映射到参数空间，通过累积投票检测形状。  
   - **直线检测**：参数方程为 $\rho = x\cos\theta + y\sin\theta$。  
   - **优点**：抗噪性强，适合不连续边缘的检测。  

---

#### **8.4 阈值分割**
1. **人工选择法**  
   - **直方图谷底法**：选择双峰直方图的谷底作为阈值。  
   - **示例**：若直方图在灰度级3处为谷，则分割阈值为3。  

2. **自动阈值法**  
   - **迭代法**：  
     1. 初始阈值设为图像中值。  
     2. 根据阈值分割为两类，计算两类的灰度均值 $\mu_1, \mu_2$。  
     3. 更新阈值 $T = \frac{\mu_1 + \mu_2}{2}$，迭代至收敛。  

3. **分水岭算法**  
   - **原理**：将图像视为地形图，模拟注水过程，分割吸水盆地（区域）与分水岭（边界）。  
   - **步骤**：  
     1. 计算梯度图像。  
     2. 标记前景和背景种子点。  
     3. 模拟注水，生成区域分割结果。  

---

#### **8.5 区域分割**
1. **区域生长法**  
   - **步骤**：  
     1. 选择种子像素。  
     2. 按相似性准则（如灰度差<阈值）合并邻域像素。  
     3. 迭代直至无新像素加入。  
   - **示例**：种子点灰度8，合并邻域灰度差≤2的像素。  

2. **区域分裂合并法**  
   - **步骤**：  
     1. 将图像初始化为单一区域。  
     2. **分裂**：若区域不满足均匀性，四叉树分割为子区域。  
     3. **合并**：合并相邻且相似的子区域。  
   - **终止条件**：所有区域满足均匀性且无法合并。  

---

#### **关键总结**
| **方法**          | **核心思想**                  | **适用场景**              |  
|--------------------|-----------------------------|--------------------------|  
| **Canny边缘检测**  | 多步骤优化抗噪与定位          | 高精度边缘提取（如医学影像） |  
| **霍夫变换**       | 参数空间投票检测形状          | 不连续边缘或特定形状检测     |  
| **分水岭算法**     | 模拟地形注水分离区域          | 复杂背景下的多目标分割       |  
| **区域生长**       | 种子扩张合并相似像素          | 均匀区域提取（如细胞分割）    |  

---







### 第九章 图像表示与描述

---

#### 9.1 图像表示
1. **边界表示 - 链码**  
   - **定义**：用方向编码表示图像边界的走向，适用于4邻域或8邻域连接。  
   - **链码类型**：  
     - **直接链码**：直接记录边界点的邻域方向（如4邻域方向：左0、上1、右2、下3）。  
     - **差分链码**：记录相邻方向的变化量（对旋转不敏感）。  
   - **方向规则**：  
     - **4邻域**：优先顺序为左→上→右→下。  
     - **8邻域**：优先顺序为左→左上→上→右上→右→右下→下→左下。  
   - **示例**：  
     - **直接链码**：从起点A出发的4邻域链码序列为 `2,4,2,4,4,4,0,2,2,2,0,2,2,0,0,2,2,2,2,2,0,2,0,2,2,4,4,2`。  
     - **差分链码**：通过相邻方向差值计算（如方向变化：0表示同方向，±1表示转向）。  

   - **特点**：  
     - **一阶差分码**：对边界旋转不敏感，计算方式为 `差分码 = (当前方向 - 前一个方向) mod 4（或8）`。  
     - **应用场景**：形状匹配、边界跟踪。



---



#### 9.2 形态学图像处理




1. **腐蚀（Erosion）**  
   - **定义**：缩小目标区域，消除细小结构。  
   - **操作步骤**：  
     1. 将结构元原点移动到目标像素。  
     2. **判定条件**：若结构元覆盖区域全为1，则腐蚀后原点位置为1，否则为0。  
   - **数学表达式**：  
     $$
     A \ominus B = \{ z | B_z \subseteq A \}
     $$  
   - **效果**：  
     - 消除孤立点、细线。  
     - 缩小目标区域边界。  





2. **膨胀（Dilation）**  
   - **定义**：扩大目标区域，填充空洞或断裂。  
   - **操作步骤**：  
     1. 将结构元原点移动到背景像素（值为0）。  
     2. **判定条件**：若结构元覆盖区域有至少一个1，则膨胀后原点位置为1，否则为0。  
   - **数学表达式**：  
     $$
     A \oplus B = \{ z | \hat{B}_z \cap A \neq \emptyset \}
     $$  
   - **效果**：  
     - 连接相邻区域，修复断裂边界。  
     - 增大目标区域尺寸。  





3. **开运算与闭运算**  
   - **开运算（Opening）**：先腐蚀后膨胀。  
     - **作用**：平滑轮廓，消除毛刺和小凸起。  
   - **闭运算（Closing）**：先膨胀后腐蚀。  
     - **作用**：填充孔洞，连接邻近区域，平滑凹槽。  
   - **特点**：  
     - 开运算抑制亮区域细节，闭运算抑制暗区域细节。  
     - 对噪声鲁棒，常用于去噪和形状简化。  




---





####  9.3 形态学关键对比
| **操作**   | **输入条件**       | **输出规则**                     | **主要应用**                |  
|------------|--------------------|----------------------------------|---------------------------|  
| **腐蚀**   | 目标区域（1像素）  | 结构元覆盖全为1时保留原点        | 消除噪声、分离粘连物体      |  
| **膨胀**   | 背景区域（0像素）  | 结构元覆盖存在1时设置原点为1    | 连接断裂、填充孔洞          |  
| **开运算** | 先腐蚀后膨胀       | 保留主体结构，去除细小突起       | 平滑边界、去除毛刺          |  
| **闭运算** | 先膨胀后腐蚀       | 填充孔洞，保持主体尺寸           | 闭合缺口、修复断裂          |  

---




### 第十章 视频分析：目标检测与跟踪

---

#### **10.1 概论**
- **定义**：视频分析是检测、识别、跟踪视频序列中的目标，并对其行为进行理解和描述的技术。
- **核心挑战**：
  - **形态变化**：目标姿态变化导致特征偏移（如人体动作变化）。
  - **尺度变化**：目标远近导致跟踪框无法自适应（如车辆由远及近）。
  - **遮挡与消失**：目标被遮挡或移出画面（如行人被车辆遮挡）。
  - **图像模糊**：光照变化、运动模糊、低分辨率影响特征提取。

- **应用场景**：
  - **安防系统**：监控、车牌识别、可疑目标跟踪。
  - **智能交通**：流量控制、违章检测。
  - **医学影像**：病灶区域识别与动态监测。
  - **工业检测**：产品缺陷检验、装配精度分析。

---

#### **10.2 目标检测方法**
**目标检测的基本思想**：抑制背景、消除噪声、突出目标 
 
**突出目标的方法**：   
+ 灰度奇异性特征
+ 几何形状特征
+ 运动特征
+ 频谱特征


不同情况采用不同的方法：
+ 对于目标与背景亮度差异较大、且背景比较简单的情况，通常会采用利用**阈值分割**的方法来提取目标；
+ 对于复杂背景下的大目标，需要利用目标的几何形状特征或运动特征等来提取目标。静止背景下常用的方法有**背景差分法、帧间差分法**等，运动背景下常用的有**背景配准法、光流法、运动估计法**等；
+ 低信噪比下小目标检测是难点也是重点，通常采用**滤波**的方法。常用的有**三维匹配滤波、动态规划法、多级假设检验**等。


1. **静止目标检测**：
   - **图像分割**：基于阈值、边缘、区域特性分割目标区域。
   - 图像分割的基本策略：
        - 把像素按灰度划分到各个物体对应的区域中去；
        - 先确定边缘像素点，然后将它们连接起来构成所需的边界；
        - 确定存在于区域间的边界；
   - **特征匹配**：利用角点、边缘等局部特征或形状全局特征。手工配准和自动配准
  
2. **运动目标检测**：
   - **静止背景下的检测（如一个固定的摄像头）**：
     - **帧间差分法**：将前后两帧图像对应像素点的灰度值相减，在环境亮度变化不大的情况下，若对应像素灰度相差很小，可以认为此处景物是静止的，若图像区域某处的灰度变化很大，认为是由于图像中运动物体引起的，将这些区域标记下来，利用这些标记的像素区域，就可以求出运动目标在图像中的位置。  
       **公式**：  
       $$
       D_k(x,y) = 
       \begin{cases} 
       1 & \text{若 } |f_{k}(x,y) - f_{k-1}(x,y)| > T \\
       0 & \text{否则}
       \end{cases}
       $$
       **优缺点**：  
       - ✅ 
       - 对动态背景适应快
       - 计算速度快
       - 占用系统资源少
       - 特别适用于噪声较少的红外视频 
       - ❌ 
       - 对噪声较大的可见光视频效果不理想
       - 该算法假定目标是不断运动的。如果物体静止一段时间，那么该算法将检测不到目标
       - 目标内部易出现空洞（如车辆大范围运动时车身中部漏检）
       - 该算法一般检测不到移动目标的全部

     - **背景差分法**：采用图像序列中的当前帧和背景参考模型比较来检测运动物体,其性能依赖于所使用的背景建模技术。通过与背景模型对比提取运动目标。  
       **步骤**：
       1. 建立背景模型（如高斯混合模型）。
       2. 当前帧与背景差分并二值化。
       **应用实例**：监控摄像头中行人检测，背景建模需动态更新以适应光照渐变。

       **优缺点**：
       - ✅ 
       - 背景差分法检测运动目标速度快，检测准确，易于实现。其关键是背景图像的获取
       - ❌ 
       - 在实际应用中，静止背景是不易直接获得的，同时，由于背景图像的动态变化，需要通过视频序列的帧间信息来估计和恢复背景，即背景重建，所以要选择性的更新背景。


| **对比维度**       | **帧间差分法**                                                                 | **背景差分法**                                                                 | 
|---------------------|-------------------------------------------------------------------------------|--------------------------------------------------------------------------------|
| **核心原理**        | 相邻帧灰度差检测运动目标                                                      | 当前帧与背景模型差检测运动目标                                                |
| **是否需要背景模型** | 否                                                                           | 是（需初始化静态背景或动态更新）                                              |
| **适用场景**        | 动态背景（光线发生变化，多目标运动）                                            | 静态背景（固定摄像机场景，如监控摄像头）                                      |
| **计算复杂度**      | 低（仅需两帧运算）                                                          | 中（需维护背景模型）                                                          |
| **抗光照变化**      | ✅ 强（依赖相邻帧，短时间光照变化影响小）                                     | ❌ 弱（若背景模型未更新，易受光照渐变干扰）                                    |
| **目标完整性**      | ❌ 较差（目标内部易产生“空洞”）                                               | ✅ 较好（背景模型准确时，目标轮廓完整）                                        |
| **抗噪性**          | ❌ 弱（噪声直接影响帧间差异）                                                | ✅ 中（依赖背景模型质量，需滤噪处理）                                           |
| **是否需要背景初始化** | 否                                                                           | 是（需预先获取无目标的背景图或在线建模）                                      |
| **实时性**          | ✅ 高（仅需两帧运算）                                                         | 中（需持续更新背景模型）                                                       |
| **典型应用**        | 动态背景下的快速运动检测（如交通监控中移动车辆）                              | 固定场景下的目标跟踪（如超市收银台商品检测）                                    |
| **优缺点总结**      | **优点**：计算快、适应动态场景。<br>**缺点**：目标断裂、对噪声敏感。         | **优点**：目标提取完整。<br>**缺点**：背景模型维护复杂、对光照敏感。           |




- **运动背景下的检测**：
  - **光流法**：根据像素运动矢量分离目标与背景。  
    **原理**：基于Horn-Schunck算法或Lucas-Kanade算法计算光流场。
  - **运动参数估计法**：通过块匹配或贝叶斯方法估计全局运动参数，补偿背景运动。

---

#### **10.3 目标跟踪方法**
+ 远距离，目标面积较小、机动性不强，通常采用滤波方法跟踪目标以提高跟踪精度。
+ 近距离，目标具有一定面积其帧间抖动较大时，一般采用窗口质心跟踪或匹配跟踪方法以保持跟踪的稳定性和精度。



1. **目标表示方法**：
   | **表示方式**     | **示意图**                     | **适用场景**                |
   |-------------------|--------------------------------|---------------------------|
   | **质心表示**     | 单个点（如无人机跟踪点目标）    | 小目标或点目标              |
   | **几何框表示**   | 矩形/椭圆框（如车辆跟踪）       | 刚体或简单非刚体目标       |
   | **轮廓表示**     | 边界多边形（如行人跟踪）        | 复杂形状的非刚体目标        |
   | **骨架模型**     | 中轴线骨架（如手势跟踪）        | 关节类目标或柔性物体       |


2. **跟踪任务分类**：
   - **单目标跟踪**：追踪单一目标的位置与轨迹（如足球比赛中的球员跟踪）。
   - **多目标跟踪**：同时追踪多个目标并处理交互（如交通路口车辆跟踪）。
   - **行人重识别（Re-ID）**：跨摄像头匹配行人身份（如跨视角监控系统）。


3. **经典跟踪算法**：
   - **模板匹配法(Template Matching)**：
     - **原理**：滑动窗口遍历图像，计算与模板的相似度（如归一化平方差）。  
     - **适用场景**：目标形态固定的小范围跟踪（如固定摄像头下的商品识别）。
     - 使用误差平方和法匹配测度：
![alt text](image.png)
     - 当原图像发生旋转或缩放时，不能实现匹配。


   - **均值漂移（Mean Shift）**：
     - **步骤**：
       1. 初始化目标颜色模型（直方图）。
       2. 迭代计算概率密度梯度方向，移动窗口至密度峰值。
     - **公式**：  
       $$
       M(\mathbf{x}) = \frac{\sum_{i=1}^n K(\mathbf{x} - \mathbf{x}_i) w_i}{\sum_{i=1}^n K(\mathbf{x} - \mathbf{x}_i)}
       $$
       **特点**：✅ 适应颜色变化，适合颜色鲜明的目标（如红色车辆跟踪）。


4. **基于核相关滤波的跟踪算法**
   - **卡尔曼滤波**：
     - **原理**：基于运动模型预测目标位置，结合观测值更新估计。  
     - **适用场景**：线性运动目标的平滑跟踪（如导弹轨迹预测）。




5. **深度学习跟踪**：
   - **基于CNN的跟踪**：利用卷积神经网络提取深度特征（如SiamFC、DeepSort）。  
   - **端到端模型**：联合检测与跟踪（如Faster R-CNN + LSTM）。

---

#### **10.4 关键算法对比**
| **算法**         | **核心思想**              | **优点**                  | **缺点**                  | **适用场景**          |
|-------------------|--------------------------|--------------------------|---------------------------|-----------------------|
| **帧间差分法**   | 相邻帧差提取运动区域      | 实时性强                 | 目标内部空洞，噪声敏感    | 动态背景简单场景      |
| **背景差分法**   | 与背景模型对比检测目标    | 精度高                   | 依赖背景模型更新          | 固定摄像头监控        |
| **Mean Shift**    | 概率密度梯度迭代跟踪      | 适应颜色变化             | 对快速运动目标失效        | 颜色对比显著目标      |
| **卡尔曼滤波**   | 运动模型预测与校正        | 噪声鲁棒性强             | 仅适合线性运动            | 匀速/匀加速运动目标 |















































